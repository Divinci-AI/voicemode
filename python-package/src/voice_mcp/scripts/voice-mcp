#!/bin/bash
# Wrapper script for voice-mcp MCP server.
# This allows the server to be run from .mcp.json for testing.

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PACKAGE_DIR="$SCRIPT_DIR/../python-package"

# Check if we're in the development environment
if [ -f "$PACKAGE_DIR/.venv/bin/python" ]; then
    # Use the venv Python which has all dependencies
    exec "$PACKAGE_DIR/.venv/bin/python" -m voice_mcp.server "$@"
elif command -v uv >/dev/null 2>&1; then
    # Use uv run as fallback
    cd "$PACKAGE_DIR" && exec uv run python -m voice_mcp.server "$@"
else
    # Try system Python as last resort
    export PYTHONPATH="$PACKAGE_DIR/src:$PYTHONPATH"
    exec python3 -m voice_mcp.server "$@"
fi